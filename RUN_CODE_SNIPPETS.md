# Running Senzing Rust SDK Code Snippets

This guide explains how to run all the Rust code snippet examples using the provided scripts.

## 🚀 Quick Start

### Option 1: Comprehensive Script (Recommended)
```bash
./run_all_code_snippets.sh
```

### Option 2: Quick Test Script
```bash
./quick_test_snippets.sh
```

### Option 3: Manual Individual Examples
```bash
cd code-snippets/rust/snippets/information/get_version
cargo run
```

## 📋 Prerequisites

### Required Environment Variable
The scripts will automatically set a default SQLite configuration, but you can override it:

```bash
export SENZING_ENGINE_CONFIGURATION_JSON='{
  "PIPELINE": {
    "CONFIGPATH": "/etc/opt/senzing",
    "RESOURCEPATH": "/opt/senzing/er/resources",
    "SUPPORTPATH": "/opt/senzing/data"
  },
  "SQL": {
    "CONNECTION": "sqlite3://na:na@/tmp/G2C.db"
  }
}'
```

### System Requirements
- Rust/Cargo installed
- Senzing SDK installed at `/opt/senzing/er/` (optional for some examples)

## 🛠 Script Options

### Comprehensive Script (`run_all_code_snippets.sh`)

**Basic Usage:**
```bash
./run_all_code_snippets.sh
```

**Available Options:**
```bash
./run_all_code_snippets.sh --help       # Show help
./run_all_code_snippets.sh --list       # List all examples
./run_all_code_snippets.sh --check      # Only compile, don't run
./run_all_code_snippets.sh --verbose    # Verbose output
```

**Features:**
- ✅ Comprehensive error handling and logging
- ✅ Execution timeout protection (30s per example)
- ✅ Detailed progress reporting with colors
- ✅ Prerequisites checking
- ✅ Organized execution order (dependencies first)
- ✅ Results summary and detailed logging
- ✅ Creates `code_snippets_run.log` and `code_snippets_results.txt`

### Quick Test Script (`quick_test_snippets.sh`)

**Usage:**
```bash
./quick_test_snippets.sh
```

**Features:**
- ⚡ Fast execution (15s timeout per example)
- ⚡ Minimal output - just pass/fail status
- ⚡ Perfect for CI/CD or quick verification
- ⚡ Returns exit code 0 if all pass, 1 if any fail

## 📊 Example Execution Order

The comprehensive script runs examples in this optimal order:

1. **Information** → Get version and system info
2. **Initialization** → Set up environment and prime engine
3. **Configuration** → Initialize and register data sources
4. **Loading** → Load sample records
5. **Searching** → Search and analyze entities
6. **Deleting** → Clean up test data
7. **Cleanup** → Purge repository

## 📁 Output Files

### Generated by Comprehensive Script:
- `code_snippets_run.log` - Detailed execution log
- `code_snippets_results.txt` - Summary report with statistics

### Log File Contents:
```
Code Snippets Execution Log - Mon Jan 15 2024
================================================
[1/12] Processing: information/get_version
======================================
   Compiling get_version v0.1.0
    Finished dev profile
     Running target/debug/main
Retrieving Senzing version and license information...
✅ Version information retrieved successfully!
```

### Results File Contents:
```
SUMMARY
-------
Total Examples: 12
Successful: 12
Failed: 0
Success Rate: 100%

SUCCESSFUL EXAMPLES (12)
  ✅ information/get_version (2s)
  ✅ initialization/environment_and_hubs (1s)
  ✅ initialization/engine_priming (3s)
  ...
```

## 🐛 Troubleshooting

### Common Issues and Solutions:

**1. Permission Denied**
```bash
chmod +x run_all_code_snippets.sh
chmod +x quick_test_snippets.sh
```

**2. Environment Variable Not Set**
The scripts automatically set defaults, but you can customize:
```bash
export SENZING_ENGINE_CONFIGURATION_JSON='{"PIPELINE":...}'
```

**3. Senzing SDK Not Found**
Some examples will show warnings but continue with limited functionality:
```
⚠️  Senzing SDK not found at /opt/senzing/er
ℹ️  Some examples may fail without proper Senzing installation
```

**4. Compilation Errors**
```bash
# Check individual example
cd code-snippets/rust/snippets/loading/load_records
cargo check

# View detailed errors
./run_all_code_snippets.sh --verbose
```

**5. Examples Timing Out**
Increase timeout in the script or run individually:
```bash
cd code-snippets/rust/snippets/problematic/example
cargo run
```

### Debug Mode:
```bash
RUST_BACKTRACE=1 ./run_all_code_snippets.sh
```

## 📈 Expected Results

**Successful Run Output:**
```
🚀 Quick Testing All Rust Code Snippets...

Testing information/get_version... ✅
Testing initialization/environment_and_hubs... ✅
Testing initialization/engine_priming... ✅
Testing configuration/init_default_config... ✅
Testing configuration/register_data_sources... ✅
Testing loading/load_records... ✅
Testing loading/load_via_loop... ✅
Testing searching/search_records... ✅
Testing searching/why_search... ✅
Testing information/database_demo... ✅
Testing deleting/delete_records... ✅
Testing initialization/purge_repository... ✅

Results: 12/12 passed
🎉 All code snippets passed!
```

## 🔧 Advanced Usage

### Run Specific Categories:
```bash
# Only initialization examples
for dir in code-snippets/rust/snippets/initialization/*/; do
  cd "$dir" && cargo run && cd - >/dev/null
done
```

### Custom Configuration:
```bash
# Use PostgreSQL instead of SQLite
export SENZING_ENGINE_CONFIGURATION_JSON='{
  "PIPELINE": {
    "CONFIGPATH": "/etc/opt/senzing",
    "RESOURCEPATH": "/opt/senzing/er/resources",
    "SUPPORTPATH": "/opt/senzing/data"
  },
  "SQL": {
    "CONNECTION": "postgresql://user:password@localhost:5432/senzing"
  }
}'

./run_all_code_snippets.sh
```

The scripts provide a robust, automated way to verify that all Rust code snippets are working correctly and demonstrate the complete Senzing SDK functionality!